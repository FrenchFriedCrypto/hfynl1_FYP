<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Chart.js Split Circle with Curved Arrows</title>
  <!-- Load Chart.js from CDN -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      margin: 0;
      padding: 0;
    }
    #chartContainer {
      width: 400px;
      height: 400px;
      margin: 20px auto;
    }
  </style>
</head>
<body>

<div id="chartContainer">
  <canvas id="myChart" width="400" height="400"></canvas>
</div>

<script>
  // Basic data: Two slices, A and B
  const data = {
    labels: ['A', 'B'],
    datasets: [{
      data: [1, 1],  // 1:1 ratio => half circle for A, half for B
      backgroundColor: ['#89CFF0', '#FFB6C1'], // Left = blue, Right = pink
      borderWidth: 0
    }]
  };

  // Chart options
  // rotation: -Math.PI/2 => boundary between slices is vertical
  // circumference: 2 * Math.PI => full circle
  const options = {
    responsive: false,
    maintainAspectRatio: false,
    plugins: {
      legend: {
        display: false // hide the default legend
      }
    },
    rotation: -Math.PI / 2,  // rotate so slice boundary is vertical
    circumference: 2 * Math.PI
  };

  // Custom plugin to draw arcs with arrowheads on the chart's canvas
  const curvedArrowsPlugin = {
    id: 'curvedArrowsPlugin',
    afterDraw(chart, args, pluginOptions) {
      const { ctx, chartArea } = chart;
      // The chart area helps us find the center
      const centerX = (chartArea.left + chartArea.right) / 2;
      const centerY = (chartArea.top + chartArea.bottom) / 2;

      // Outer radius of the pie slice
      const meta = chart.getDatasetMeta(0);
      // meta.data[0] or meta.data[1] are the arcs for each slice
      // They have .outerRadius. Both slices share the same outerRadius
      const radius = meta.data[0].outerRadius;

      // We can define a helper to draw an arc with arrowheads
      function drawArcWithArrowheads(startAngle, endAngle, color) {
        ctx.save();
        ctx.strokeStyle = color;
        ctx.lineWidth = 3;
        ctx.beginPath();
        // Draw the arc. We'll add 10px beyond the pie radius so it's slightly outside.
        ctx.arc(centerX, centerY, radius + 10, startAngle, endAngle, false);
        ctx.stroke();

        // Draw arrowheads at start & end of the arc
        // We'll do small triangles oriented tangentially
        function drawArrowhead(angle) {
          const arrowSize = 8;
          // Arc point at this angle
          const x = centerX + (radius + 10) * Math.cos(angle);
          const y = centerY + (radius + 10) * Math.sin(angle);

          // The tangent direction depends on whether arc goes CCW or not
          // Here, we assume startAngle < endAngle => arc is drawn CCW
          // The tangent is angle ± 90° => angle ± Math.PI/2
          // We'll shift slightly so the arrow points along the arc direction
          const direction = angle + Math.PI / 2;

          ctx.beginPath();
          // Move to arrow tip
          ctx.moveTo(x, y);
          // One side of arrow
          ctx.lineTo(
            x + arrowSize * Math.cos(direction - 0.3),
            y + arrowSize * Math.sin(direction - 0.3)
          );
          // Other side of arrow
          ctx.lineTo(
            x + arrowSize * Math.cos(direction + 0.3),
            y + arrowSize * Math.sin(direction + 0.3)
          );
          ctx.closePath();
          ctx.fillStyle = color;
          ctx.fill();
        }

        // Draw arrowhead at start
        drawArrowhead(startAngle);
        // Draw arrowhead at end
        drawArrowhead(endAngle);

        ctx.restore();
      }

      // Top arc: from left side to right side (roughly)
      // Left side is angle = -Math.PI, right side is angle = 0
      // We'll offset them a bit so they're above the center
      drawArcWithArrowheads(-Math.PI + 0.3, -0.3, 'teal');

      // Bottom arc: from right side back to left side
      // We'll do from 0.3 to Math.PI - 0.3
      // This draws an arc in the same CCW direction, from ~0.3 to ~2.84
      drawArcWithArrowheads(0.3, Math.PI - 0.3, 'orange');
    }
  };

  // Create the Chart.js pie chart
  const ctx = document.getElementById('myChart').getContext('2d');
  new Chart(ctx, {
    type: 'pie',
    data,
    options,
    plugins: [curvedArrowsPlugin]
  });
</script>

</body>
</html>
